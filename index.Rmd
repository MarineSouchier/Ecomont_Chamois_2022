---
title: "Projet Chamois"
date: "`r Sys.Date()`"
output: 
  rmdformats::readthedown:
    highlight: kate
    number_sections: TRUE
    df_print: kable
    
---


# Chargement des librairies
***

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(corrplot)
library(lmerTest)
library(ade4)
library(splines)
library(car)
library(plotly)
library(DT)
library(Hmisc)
library(kableExtra)
library(knitr)
```

# Import et description du jeu de données
***

## Import des données

```{r, echo=FALSE}
setwd(".")
load('cham.Rdata')
datatable(cham, rownames = FALSE, filter="top", options = list(pageLength = 5, scrollX=T) )
```
## Description des données {.tabset .tabset-fade .tabset-pills}

***

### Résumé des données  

```{r message=FALSE, warning=FALSE, echo=FALSE}
str(cham)%>%
  kable("latex", booktabs = T)
  summary(cham)%>%
  kable(format = "latex")
describe(cham)
```


### Histogramme années d'observation

```{r, echo=FALSE}
hist(cham$year, breaks = 27)
```

### Histogramme individus suivis

```{r, echo=FALSE}
hist(table(cham$id), breaks=16, xlim=c(0,16), ylim=c(0,40))
```

### Présentation des données

Le data frame est constitué de 7 variables et 1328 observations.
Chaque observation correspond à l'information de fécondité associée à une femelle chamois et relative à une année donnée.
Le jeu de données résume les suivis réalisés entre 1991 et 2017 sur 27 années. D'après l'histogramme des années d'observation, les années entre 2004 et 2006 sont les années pour lesquelles le nombre de chamois suivis a été le plus important (cf histogramme années d'observation). 217 femelles chamois ont été suivies au total. Le nombre d'années de suivi varie selon les femelles entre 1 et 16 années (cf histogramme individus suivis).

## Prétraitement du jeu de données
### Elimination des données aberrantes

Les chamois observés après leur mort ou avant leur naissance sont retirés du jeu de donnees.

```{r}
cham <- cham %>% 
  filter(year<=ydth | is.na(cham$ydth)) %>%
  filter(year>=coh)
```


### Création des variables âge (age) et longévité (long)

```{r}
cham2 <- cham %>%
  summarise(cham, age= year-coh, long=ydth-coh, agemark=anmark-coh)
```

# Question 1 : Lien fécondité annuelle et âge des femelles
***
## Représentation graphique des données
### Représentation par classe d'âge

```{r message=FALSE, warning=FALSE, echo=FALSE}
cham_age <- cham2 %>% 
  group_by(age) %>%
  dplyr::summarise(totnaissance= sum(fec), taillepop=n(), fecmean=totnaissance/n())

cham_age$fecmean <- round(cham_age$fecmean, 2)

  plot1 <- ggplot(cham_age, aes(x=age, y=fecmean)) + 
    geom_bar(color="blue", fill=rgb(0.1,0.4,0.5,0.7), stat = "identity") + 
    labs(title = "Fécondité moyenne de la population en fonction de l'age",x="Age", y="Fécondité moyenne de la population") + 
    theme(plot.title = element_text(hjust = 0.5)) + 
    geom_smooth()
ggplotly(plot1)
```


### Représentation sans grouper par classe d'âge 
#### Utilisation de la fonction jitter

```{r message=FALSE, warning=FALSE, echo=FALSE}
plot2 <- ggplot(cham2, aes(x=age, y=fec)) + 
    geom_jitter(width = 0.55, height = 0) + 
    labs(title = "Fécondité annuelle en fonction de l'age",x="Age", y="Fécondité annuelle") +
    theme(plot.title = element_text(hjust = 0.5)) + 
    geom_smooth()
ggplotly(plot2)
```


#### Utilisation de la fonction geom_count

```{r message=FALSE, warning=FALSE, echo=FALSE}
plot3 <- ggplot(cham2, aes(x=age, y=fec)) +
    geom_count() + 
    labs(title = "Fécondité annuelle en fonction de l'age",x="Age", y="Fécondité annuelle")+
    theme(plot.title = element_text(hjust = 0.5))+
    geom_smooth(); plot3
```

Graphiquement, une augmentation de l'âge des chamois semble engendrer une diminution de la fécondité des chamois avec une inflexion de la courbe observée autour de 10 ans.

## Analyse statistique du lien entre fécondité annuelle et l'âge des femelles 
### Modèles de régression lineaire generalisé avec effets aléatoires {.tabset .tabset-fade .tabset-pills}

***

#### Premier modèle testé

Le premier modèle appliqué est un modèle glm qui utilise la fonction de lien binomial afin de prendre en compte le fait que la variable réponse soit une variable binomiale. La variable "id" est désignée comme variable aléatoire pour prendre en compte le fait que les observations sont répetées sur les mêmes individus sur plusieurs années.

```{r, echo=FALSE}
glm1 <- glmer(fec ~ age + (1| id),data=cham2, family = binomial)
summary(glm1)
Anova(glm1)
```

Interpretation des coefficients:
```{r, echo=FALSE}
dispersion_glm1 <- 1756/1314;dispersion_glm1 #Surdispersion = deviance/df
summary(glm1)$coefficients
exp(summary(glm1)$coefficients[2])
Coeff <-((1/exp(summary(glm1)$coefficients[2]))-1)*100
```

L'AIC de ce modèle est de 1736.
Avec ce modele, la dispersion calculée comme le ratio variance/df est de 1.3 donc il n'y a pas de surdispersion observee.
On calcule en utilisant la fonction inverse de logit le coefficient qui permet d'exprimer la fécondité annuelle (en prenant en compte la fonction de lien) en fonction de l'âge.
Il est `r Coeff`% moins vraisemblable que les chamois aient un petit lorsque leur âge augmente d'un an mais la p value est de 0.25 donc l'impact de l'âge via ce premier modèle n'est pas significatif.


#### Second modèle testé

Un modèle quadratique est testé par la suite pour prendre en compte la tendance de la ligne de régression observée sur les graphiques qui présente une inflexion autour de 10 ans.

```{r, echo=FALSE}
glm1q <- glmer(fec ~ age + I(age^2) + (1| id),data=cham2, family = binomial)
summary(glm1q)
```

La variable age est centrée normée car le modèle n'arrive pas à converger.

```{r, echo=FALSE}
age_scale <- scale(cham2$age, center=TRUE, scale=TRUE)
glm1q <- glmer(fec ~ age_scale + I(age_scale^2) + (1| id),data=cham2, family = binomial)
summary(glm1q)
```
Interpretation des coefficients:
```{r, echo=FALSE}
dispersion_glm1q <- 1666/1313;dispersion_glm1q #Surdispersion = deviance/df
summary(glm1q)$coefficients
```
L'AIC de ce modèle est de 1674.
Avec ce modèle, la dispersion calculée est de 1.3 donc il n'y a pas de surdispersion observée.
L'AIC de ce modèle 2 quadratique < l'AIC du modèle 1 linéaire donc le modèle quadratique est plus adapté comme attendu graphiquement. 
Une observation des coefficients associés aux termes âge et âge^2 indique que le terme "âge" n'est pas significatif dans la prédiction de la variable réponse alors que la p value associée au terme "âge^2" < 0.01. La fonction carré est donc testée.

#### Troisième modèle testé

```{r, echo=FALSE}
glm1c <- glmer(fec ~  I(age_scale^2) + (1| id),data=cham2, family = binomial)
summary(glm1c)
```
Interpretation des coefficients:
```{r,echo=FALSE}
dispersion_glm1c <- 1668/1314;dispersion_glm1c #Surdispersion = deviance/df
summary(glm1c)$coefficients
exp(summary(glm1c)$coefficients[[2]])
Coeffb <- ((1/exp(summary(glm1)$coefficients[2]))-1)*100
```
L'AIC de ce modèle est de 1674.
Avec ce modèle, la dispersion calculée est 1.3 donc il n'y a pas de surdispersion observée.
Il est `r Coeffb`% moins vraisemblable que les chamois aient un petit lorsque leur âge au carré augmente d'une unité (p value < 0.05).


#### 4ème modèle testé

On rajoute la variable "year" comme variable aléatoire pour prendre également en compte le fait que les mêmes individus ont été suivis sur les mêmes années.

```{r, echo=FALSE}
glm1d <- glmer(fec ~  I(age_scale^2) + (1| id)+ (1| year),data=cham2, family = binomial)
summary(glm1d)
```
Interpretation des coefficients:
```{r, echo=FALSE}
dispersion_glm1d <- 1633/1313;dispersion_glm1d #Surdispersion = deviance/df
```
L'AIC de ce modèle est de 1641.
Avec ce modèle, la dispersion calculée est de 1.2 donc il n'y a pas de surdispersion observée.

### Conclusions
```{r}
anova(glm1, glm1q, glm1c, glm1d)
```
Le modèle glm1d présente le plus faible AIC.
La variable "âge" présente un effet significatif sur la fécondité annuelle via ce modèle ce qui n'est pas surprenant car graphiquement la ligne de régression présentait une courbe avec une diminution de la fécondité pour des âges élevés.




# Variation de la fécondité annuelle en fonction du temps
***
## Représentation graphique des données
### Représentation graphique par année

```{r message=FALSE, warning=FALSE, echo=FALSE}
cham_ans = cham2 %>% 
  group_by(year) %>% 
  dplyr::summarise(totnaissance= sum(fec), taillepop=n(), agemoyen=mean(age)) %>% 
  mutate(fecperan=totnaissance/taillepop)
cham_ans$fecperan <- round(cham_ans$fecperan, 2)
```


```{r out.width=c('50%', '50%'), fig.show='hold',message=FALSE, warning=FALSE, echo=FALSE}
plot4 <- ggplot(cham_ans, aes(x=year, y=fecperan)) +
    geom_bar(color="blue", fill=rgb(0.1,0.4,0.5,0.7), stat = "identity") + 
    labs(title = "Fécondité moyenne de la population en fonction des annees",x="Annees", y="Fécondité moyenne") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot4

plot5 <- ggplot(data = cham_ans, aes(x = year,y=agemoyen))+
     labs(title = "Age moyen de la population en fonction des annees",x="Annees", y="Age moyen") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_point()+
    geom_smooth(); plot5
```

### Représentation graphique sans grouper par annee

```{r out.width=c('33%', '33%', '33%'), fig.show='hold', message=FALSE, warning=FALSE, echo=FALSE}
plot6 <- ggplot(cham2, aes(x=year, y=fec)) + 
    labs(title = "Fécondité annuelle en fonction des annees",x="Années", y="Fécondité annuelle") +
    geom_jitter(width = 0.55, height = 0) +
    geom_smooth()+
    theme(plot.title = element_text(hjust = 0.5)); plot6

plot7 <- ggplot(cham2, aes(x=year, y=fec)) + 
    geom_count() + 
    labs(title = "Fécondité annuelle en fonction des années",x="Années", y="Fécondité annuelle") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot7

plot8 <- ggplot(data = cham_ans, aes(x = year,y=agemoyen))+
   labs(title = "Age moyen de la population en fonction des annees",x="Années", y="Age moyen") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_point()+
    geom_smooth(); plot8
```
Graphiquement, la variable âge ne semble pas avoir d'effet sur la fécondité annuelle des chamois malgré le fait que l'âge moyen de la population augmente sensiblement avec les années.

## Analyse statistique du lien entre fécondité annuelle et années
### Modèles de régression lineaire generalisé avec effets aléatoires {.tabset .tabset-fade .tabset-pills}

***

#### Premier modèle

Le premier modèle appliqué est un modèle glm qui utilise la fonction de lien binomial afin de prendre en compte le fait que la variable réponse soit une variable binomiale. La variable "id" est désignée comme variable aléatoire pour prendre en compte le fait que les observations sont répetées sur les mêmes individus sur plusieurs années. 

```{r, echo=FALSE}
glm5 <- glmer(fec ~ year + (1| id),data=cham2, family = binomial)
year_scale <-scale(cham2$year, center = TRUE, scale=TRUE)

glm5 <- glmer(fec ~ year_scale + (1| id),data=cham2, family = binomial)
summary(glm5)
```

Interpretation des coefficients:
```{r, echo=FALSE}
dispersion_glm5 <- 1757/1314;dispersion_glm5 #Surdispersion = deviance/df
```
L'AIC de ce modèle est de 1763.
Avec ce modèle, la dispersion calculée comme le ratio variance/df est de 1.3 donc il n'y a pas de surdispersion observée.
D'après la p-value > 0.82, il n'y a pas d'effets significatifs de la variable "year" sur la fécondité annuelle comme supposé préalablement par les représentations graphiques.
La variable "âge" n'ayant pas d'effets significatifs sur la fécondité annuelle des chamois, il n'y a pas d'utilité à appliquer des modèles avec effets additifs ou multiplicatifs en utilisant les variables âge et année.


# Lien entre fecondite totale et longevite des animaux
***
## Représentation graphique des données
### Représentation sans prendre en compte le nombre d'annees de suivi


```{r message=FALSE, warning=FALSE}
cham_id = cham2 %>% 
  group_by(id) %>% 
  dplyr::summarise(feconditetotale= sum(fec), long=long, pds=pds, coh=coh, anneetot=(ydth-min(year)+1), MinAn=min(year), MaxAn=max(year), AgeMark=min(age)) %>%
  unique()%>%
  drop_na(long)
```

```{r out.width=c('50%', '50%'), fig.show='hold', message=FALSE, warning=FALSE}
plot9 <-ggplot(cham_id, aes(x=long, y=feconditetotale)) +
    geom_count() +
    labs(title = "Fecondite totale en fonction de la longevite",x="Longevite", y="Fecondite totale") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot9

plot10 <- ggplot(cham_id, aes(x=long, y=feconditetotale)) +
    geom_jitter(width = 0.25, height = 0.25)+
     labs(title = "Fecondite totale en fonction de la longevite",x="Longevite", y="Fecondite totale") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot10
```
### Prise en compte du biais apporté par le nombre d'années de suivi

Tous les chamois n'ont pas été marqués au même age et donc n'ont pas été suivis le même nombre d'annee comme le montre l'histogramme ci-dessous. 

```{r message=FALSE, warning=FALSE}
plot11 <- ggplot(cham_id, aes(x=anneetot)) +
    geom_histogram(bins = 30)+
     labs(title = "Nombre annees de suivi des chamois",x="Nombre d'annees") +
    theme(plot.title = element_text(hjust = 0.5)); plot11
plot(jitter(cham_id$long), jitter(cham_id$anneetot))
```
Le nombre d'annees de suivi n'est donc pas égal à la longévité des individus comme illustré par le graphique ci-dessous.
```{r message=FALSE, warning=FALSE}
plot5 <- ggplot(data = cham_id, aes(x = anneetot,y=long))+
     labs(title = "Correlation entre le nombre d'annees de suivi et la longevite",x="Annees de suivi", y="Longevite") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_point()+
    geom_smooth(); plot5
```
On vérifie dans un premier temps, l'impact du nombre d'annees de suivi sur la fecondite totale des chamois

```{r out.width=c('50%','50%'), fig.show='hold',message=FALSE, warning=FALSE}
plot10bis <- ggplot(cham_id, aes(x=anneetot, y=feconditetotale)) +
    geom_point(stat="identity") +
    labs(title = "Fecondite totale en fonction du nombre d'annee de suivi",x="Nombre annees de suivi", y="Fecondite totale") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot10bis
```
Comme attendu, la fecondite totale augmente avec le nombre d'annees de suivi. Or il est difficile de savoir si cette augmentation est du au fait que l'individu a été marqué précocement ou si l'individu a vécu plus longtemps.

Pour pouvoir répondre à la question initiale, qui consiste à vérifier s'il y a un lien entre la fécondité annuelle et la longévité, il faut pouvoir comparer des individus suivis sur le même nombre d'année et si possible sur le maximum d'années possibles.

```{r message=FALSE, warning=FALSE}
plot11 <- ggplot(cham_id, aes(x=AgeMark)) +
    geom_histogram(bins=50)+
     labs(title = "Age de marquage des individus",x="Age") +
    theme(plot.title = element_text(hjust = 0.5)); plot11
```
En s'appuyant sur le graphique ci-dessous, l'analyse statistique va être réalisé sur un échantillon de la population suivi à savoir tous les individus marqués à 3 ans qui constitue un échantillon > 30 individus et peut permettre d'étudier l'impact de la longévité sur la fécondité totale.

On sait que la variable "année" n'a pas d'impact sur la fécondité annuelle des chamois donc le faut que les chamois aient été suivis pendant des périodes différentes n'a pas d'impact. Il faut par contre vérifier au préalable que le fait de sélectionner la fécondité de la population des individus marqués à 3 ans est représentative de la population totale de chamois. 

```{r}
r <- tapply(cham2$fec, cham2$agemark, mean)
r
Age3 <- cham2[cham2$agemark==3,]
Ageautre <- cham2[cham2$agemark!=3,]
mean(Age3$fec)
mean(Ageautre$fec)

#Voir avec Karim quel test
```

### Création du sous-échantillon pour répondre à la question

```{r}
cham3 <- cham_id %>% 
  filter(AgeMark==3)
```

### Représentation graphique

```{r, fig.show='hold', message=FALSE, warning=FALSE}
plot9 <-ggplot(cham3, aes(x=long, y=feconditetotale)) +
    geom_point() +
    labs(title = "Fecondite totale en fonction de la longevite",x="Longevite", y="Fecondite totale") +
    theme(plot.title = element_text(hjust = 0.5)) +
    geom_smooth(); plot9
```

## Analyse statistique du lien entre la fécondité annuelle et la longevite
### Tests de modèles de régression lineaire generalise avec effets aléatoires {.tabset .tabset-fade .tabset-pills}

***

#### First

Plusieurs modèles ont été testés => voir avec Karim

```{r}
lm1 <-lm(feconditetotale~long, data = cham3)
summary(lm1)
plot(lm1)

glmp <- glm(data=cham3, feconditetotale~long, family="poisson")
summary(glmp)

lm2 <- lm(feconditetotale~log(long), data = cham3)
summary(lm2)
plot(lm2)
```













# Lien entre fecondite annuelle et longevite des animaux
***

## Représentation graphique des données


```{r message=FALSE, warning=FALSE}
plot12 <- ggplot(cham2, aes(x=long, y=fec)) +
    geom_count() + 
    labs(title = "Fécondité annuelle en fonction de la longevite",x="Longevite", y="Fécondité annuelle")+
    geom_smooth()+
    theme(plot.title = element_text(hjust = 0.5)); plot12
```

```{r message=FALSE, warning=FALSE}
plot13 <- ggplot(cham2, aes(x=long, y=fec)) +
    geom_jitter(width = 0.55, height=0) + 
    labs(title = "Fécondité annuelle en fonction de la longevite",x="Longevite", y="Fécondité annuelle")+
    geom_smooth()+
    theme(plot.title = element_text(hjust = 0.5)); plot13
```

L'allure concave des lignes de régression illustre une augmentation de la fécondité annuelle avec la longévité jusqu'à atteindre un maximum autour de 13-14 ans puis une diminution de la fécondité annuelle.

## Analyse statistique du lien entre fecondite annuelle et longevite des femelles 
### Modèles de régression lineaire generalise avec effets aléatoires {.tabset .tabset-fade .tabset-pills}

***

#### First

Le premier modele applique est un modele glm qui utilise la fonction de lien binomiale afin de prendre en compte le fait que la variable réponse soit une variable binomiale. La variable "id" est désignée comme variable aléatoire pour prendre en compte le fait que les observations sont repetees sur les mêmes individus sur plusieurs annees.

```{r}
glm11 <- glmer(fec ~ long + (1| id),data=cham2, family = binomial)
long_scale <- scale(x = cham2$long,center = TRUE,scale = TRUE)
glm11 <- glmer(fec ~ long_scale + (1| id),data=cham2, family = binomial)
summary(glm11)
Anova(glm11)
```

Interpretation des coefficients:
```{r}
dispersion_glm1 <- 1212/906;dispersion_glm1 #Surdispersion = deviance/df
```
L'AIC de ce modèle = 1218.
Avec ce modele, la dispersion calculée comme le ratio variance/df = 1.3 donc il n'y a pas de surdispersion observee.
Avec ce modele, la p value associé à l'impact de la varibale "longevite" sur la fecondite annuelle est de 0.6 donc l'effet de la longevite sur la variable reponse n'est pas significatif. 

#### Second 

On applique un modèle quadratique pour prendre en compte la tendance la ligne de régression observee sur les graphiques qui présente une inflexion autour de 13-14 ans.
```{r}
glm11 <- glmer(fec ~ long_scale + I(long_scale^2)+ (1| id),data=cham2, family = binomial)
summary(glm11)
Anova(glm11)
```
Interpretation des coefficients:
```{r}
dispersion_glm1 <- 1201/905;dispersion_glm1 #Surdispersion = deviance/df
```

L'AIC de ce modèle glm1q = 1209.
Avec le modele glm1q, la dispersion calculée = 1.3 donc il n'y a pas de surdispersion observee.
L'AIC de ce modèle glm1q < l'AIC du modèle glm1 donc le modèle glm1q est plus adapté. 
Une observation des coefficients indique que le terme "x" n'est pas significatif dans la prediction de la variable reponse alors que la p value associée au terme "x2" < 0.01. La fonction carré est donc testée.

#### Third

```{r}
glm11 <- glmer(fec ~ I(long_scale^2)+ (1| id),data=cham2, family = binomial)
summary(glm11)
Anova(glm11)
```

Interpretation des coefficients:
```{r}
dispersion_glm1c <- 1201/906;dispersion_glm1c #Surdispersion = deviance/df
summary(glm11)$coefficients
exp(summary(glm11)$coefficients[[2]])
Coeffb <- ((1/exp(summary(glm11)$coefficients[2]))-1)*100
```
L'AIC de ce modèle glm1c = 1674.
Avec le modele glm1c, la dispersion calculée = 1.3 donc il n'y a pas de surdispersion observee.
Il est `r Coeffb`% moins vraisemblable que les chamois aient un petit lorsque leur longevite au carré augmente d'une unité (p value < 0.05).


Segmentation => voir avec Karim
```{r}
cham_long1 <- cham2[cham2$long<15,]
cham_long2 <- cham2[cham2$long>=15,]

plot16 <- ggplot(cham_long1, aes(x=long, y=fec)) +
    geom_count() + 
    labs(title = "Fécondité en fonction de la longevite",x="Longevite", y="Fécondité")+
    geom_smooth()+
    theme(plot.title = element_text(hjust = 0.5)); plot16

glm12 <- glmer(fec ~ long + (1| id),data=cham_long1, family = binomial)
summary(glm12)
Anova(glm12)

plot17 <- ggplot(cham_long2, aes(x=long, y=fec)) +
    geom_count() + 
    labs(title = "Fécondité en fonction de la longevite",x="Longevite", y="Fécondité")+
    geom_smooth()+
    theme(plot.title = element_text(hjust = 0.5)); plot17

glm13 <- glmer(fec ~ long + (1| id),data=cham_long2, family = binomial)
summary(glm13)
Anova(glm13)
```






# Lien entre fecondite totale et poids
***

## Représentation graphique des données
### Vérification de la comparabilite des poids selon les ages de capture

```{r message=FALSE, warning=FALSE}
cham_pds <- cham_id %>% 
  drop_na(pds)
```

```{r message=FALSE, warning=FALSE}
plot18 <- ggplot(cham_pds, aes(x=AgeMark, y=pds)) + 
    geom_point(color="blue", fill=rgb(0.1,0.4,0.5,0.7)) + 
    labs(title = "Poids selon l'age de capture",x="Age de capture", y="Poids mesuré")+
    theme(plot.title = element_text(hjust = 0.5))+
    geom_smooth();plot18

#Fiare une boucle for pour exclure outlier
(boxplot(cham_pds$pds))
out <- boxplot.stats(cham_pds$pds)$out
max(out)
cham_pds <- cham_pds%>%
  filter(pds>max(out))

hist(cham_pds$AgeMark)
plot(cham_pds$pds, cham_pds$feconditetotale)
plot(cham_pds$AgeMark, cham_pds$feconditetotale)
```
Reflechir à la section des donnes avant analyse stat pour fecondite totale


## Analyse statistique du lien entre fecondite annuelle/longevite et poids des femelles 
### Modèles de régression lineaire generalise avec effets aléatoires {.tabset .tabset-fade .tabset-pills}

***

#### First
```{r}
lm14 <- lm(feconditetotale ~ pds,data=cham_pds)
summary(lm14)

lm15 <- lm(long ~ pds,data=cham_pds)
summary(lm15)
```

### Représentation graphique de la fecondite totale en fonction du poids

```{r message=FALSE, warning=FALSE}
plot19 <- ggplot(cham_pds, aes(x=pds, y=feconditetotale)) + 
    geom_point(color="blue", fill=rgb(0.1,0.4,0.5,0.7)) + 
    geom_smooth();plot19
```

### Représentation graphique de la longevite en fonction du poids

```{r message=FALSE, warning=FALSE}
plot20 <- ggplot(cham_pds, aes(x=pds, y=long)) + 
    geom_point(color="blue", fill=rgb(0.1,0.4,0.5,0.7)) + 
    geom_smooth();plot20
```
Longevite significatif sur le poids mais pas de la fecondite totale.